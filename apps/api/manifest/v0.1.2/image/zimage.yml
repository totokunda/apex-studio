api_version: apex/v1
kind: Model
type: image
metadata:
  id: zimage
  model: zimage
  name: ZImage
  version: 0.1.2
  description: ZImage is a 6B parameter model for text-to-image for efficient image
    generation.
  tags:
  - zimage
  - t2i
  author: Tongy-MAI
  license: Apache-2.0
  demo_path: models/zimage.png
  categories:
  - text-to-image
spec:
  engine: zimage
  model_type: t2i
  engine_type: torch
  compute_requirements:
    min_cuda_compute_capability: 7.0
    supported_compute_types:
    - cuda
    - cpu
    - metal
  attention_types:
  - sdpa
  - flash
  - flash3
  - sage
  - metal_flash
  - efficient_dot_product_attention
  - xformers
  components:
  - type: scheduler
    label: Scheduler
    default: Beta57Scheduler
    scheduler_options:
    - name: Beta57Scheduler
      label: Beta57 Scheduler
      description: The Beta57 Scheduler is a scheduler for the ZImage model.
      base: src.scheduler.beta57.Beta57Scheduler
      config:
        num_train_timesteps: 1000
        # This matches RES4LYF beta57:
        alpha: 0.5
        beta: 0.7
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: FlowMatchEulerDiscreteScheduler
      label: FlowMatch Euler Discrete Scheduler
      description: The FlowMatch Euler Discrete Scheduler is a scheduler for the ZImage
        model.
      base: diffusers.FlowMatchEulerDiscreteScheduler
      config_path: Tongyi-MAI/Z-Image/scheduler/scheduler_config.json
    - name: DDIMEulerFlowScheduler
      label: DDIM Euler Flow Scheduler
      description: The DDIM Euler Flow Scheduler is a scheduler for the ZImage model.
      base: src.scheduler.ddim_euler.DDIMEulerFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: EulerAncestralFlowScheduler
      label: Euler Ancestral Flow Scheduler
      description: Euler ancestral sampler adapted for flow-matching models (ComfyUI-style).
      base: src.scheduler.flow_ancestral.EulerAncestralFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        eta: 1.0
        s_noise: 1.0
    - name: DPM2AncestralFlowScheduler
      label: DPM2 Ancestral Flow Scheduler
      description: DPM-Solver-2 ancestral sampler adapted for flow-matching models (ComfyUI-style).
      base: src.scheduler.flow_ancestral.DPM2AncestralFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        eta: 0.0
        s_noise: 1.0
    - name: DPMpp2SAncestralFlowScheduler
      label: DPM++ 2S Ancestral Flow Scheduler
      description: DPM++(2S) ancestral sampler adapted for flow-matching models (ComfyUI-style).
      base: src.scheduler.flow_ancestral.DPMpp2SAncestralFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        eta: 0.0
        s_noise: 1.0
    - name: DDPMFlowScheduler
      label: DDPM Flow Scheduler
      description: Classic DDPM reverse process adapted for flow-matching with Karras alpha_cumprod mapping and ancestral noise injection.
      base: src.scheduler.flow_ancestral.DDPMFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: EulerFlowScheduler
      label: Euler Flow Scheduler
      description: Euler method for the flow-matching ODE. Simplest deterministic sampler.
      base: src.scheduler.flow_deterministic.EulerFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: HeunFlowScheduler
      label: Heun Flow Scheduler
      description: Heun's method (trapezoidal / improved Euler) for flow-matching. 2nd-order with two model evals per step.
      base: src.scheduler.flow_deterministic.HeunFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: LMSFlowScheduler
      label: LMS Flow Scheduler
      description: Linear Multi-Step (Adams-Bashforth) method for flow-matching. Uses derivative history for higher-order extrapolation.
      base: src.scheduler.flow_deterministic.LMSFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        lms_order: 4
    - name: DPM2FlowScheduler
      label: DPM-2 Flow Scheduler
      description: DPM-Solver-2 (midpoint method) for flow-matching. 2nd-order with two model evals per step.
      base: src.scheduler.flow_deterministic.DPM2FlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: DPMpp2MFlowScheduler
      label: DPM++ 2M Flow Scheduler
      description: DPM-Solver++(2M) for flow-matching. Single-eval multi-step method using denoised history.
      base: src.scheduler.flow_deterministic.DPMpp2MFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: ResMultistepFlowScheduler
      label: RES Multistep Flow Scheduler
      description: Recursive Exponential Solver multistep for flow-matching. 2nd-order exponential integrator with phi-functions.
      base: src.scheduler.flow_deterministic.ResMultistepFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: DEISFlowScheduler
      label: DEIS Flow Scheduler
      description: Diffusion Exponential Integrator Sampler for flow-matching. Uses precomputed polynomial coefficients.
      base: src.scheduler.flow_deterministic.DEISFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        deis_order: 3
    - name: IPNDMFlowScheduler
      label: iPNDM Flow Scheduler
      description: Improved Pseudo Numerical Diffusion Model for flow-matching. Fixed Adams-Bashforth coefficients with derivative history.
      base: src.scheduler.flow_deterministic.IPNDMFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        max_order: 4
    - name: IPNDMVFlowScheduler
      label: iPNDM-v Flow Scheduler
      description: iPNDM variable step-size variant for flow-matching. More accurate with non-uniform sigma schedules.
      base: src.scheduler.flow_deterministic.IPNDMVFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        max_order: 4
    - name: GradientEstimationFlowScheduler
      label: Gradient Estimation Flow Scheduler
      description: Euler + gradient-estimation correction for flow-matching. Simple and effective.
      base: src.scheduler.flow_deterministic.GradientEstimationFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        ge_gamma: 2.0
    - name: Seeds2FlowScheduler
      label: SEEDS-2 Flow Scheduler
      description: Deterministic SEEDS-2 exponential integrator for flow-matching. Two model evals per step in logSNR space.
      base: src.scheduler.flow_deterministic.Seeds2FlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        r: 0.5
    - name: Seeds3FlowScheduler
      label: SEEDS-3 Flow Scheduler
      description: Deterministic SEEDS-3 exponential integrator for flow-matching. Three model evals per step in logSNR space.
      base: src.scheduler.flow_deterministic.Seeds3FlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: ExpHeun2X0FlowScheduler
      label: Exp Heun 2 X0 Flow Scheduler
      description: Deterministic exponential Heun 2nd-order in data-prediction (x0) and logSNR time.
      base: src.scheduler.flow_deterministic.ExpHeun2X0FlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: SASolverFlowScheduler
      label: SA-Solver Flow Scheduler
      description: Deterministic Stochastic Adams Solver for flow-matching. Predictor-corrector Adams method in logSNR space.
      base: src.scheduler.flow_deterministic.SASolverFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        predictor_order: 3
        corrector_order: 4
    - name: SASolverPECEFlowScheduler
      label: SA-Solver PECE Flow Scheduler
      description: Deterministic SA-Solver PECE (Predict-Evaluate-Correct-Evaluate) for flow-matching. Two model evals per step.
      base: src.scheduler.flow_deterministic.SASolverPECEFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        predictor_order: 3
        corrector_order: 4
    - name: HeunPP2FlowScheduler
      label: Heun++ (PP2) Flow Scheduler
      description: Heun++ method for flow-matching. Up to 3 model evals per step with weighted derivative blending.
      base: src.scheduler.flow_deterministic.HeunPP2FlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: DPMFastFlowScheduler
      label: DPM-Fast Flow Scheduler
      description: DPM-Solver-Fast for flow-matching. Mixed-order (1,2,3) DPM-Solver steps on a uniform log-sigma grid.
      base: src.scheduler.flow_deterministic.DPMFastFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: DPMAdaptiveFlowScheduler
      label: DPM-Adaptive Flow Scheduler
      description: DPM-Solver-3 with logSNR-uniform schedule for flow-matching. Approximates adaptive step-size selection.
      base: src.scheduler.flow_deterministic.DPMAdaptiveFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: LCMFlowScheduler
      label: LCM Flow Scheduler
      description: Latent Consistency Model sampler for flow-matching. Single eval per step, jumps to denoised then re-noises.
      base: src.scheduler.flow_deterministic.LCMFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
    - name: unipc
      label: UniPC (bh1)
      description: Unified Predictor-Corrector (UniPC) multistep sampler, ComfyUI-style bh1 variant.
      base: src.scheduler.unipc.UniPCMultistepScheduler
      config:
        num_train_timesteps: 1000
        prediction_type: flow_prediction
        predict_x0: true
        solver_order: 3
        solver_type: bh1
        lower_order_final: true
        use_dynamic_shifting: true
        shift: 3.0
    - name: unipc_bh2
      label: UniPC (bh2)
      description: Unified Predictor-Corrector (UniPC) multistep sampler, ComfyUI-style bh2 variant.
      base: src.scheduler.unipc.UniPCMultistepScheduler
      config:
        num_train_timesteps: 1000
        prediction_type: flow_prediction
        predict_x0: true
        solver_order: 3
        solver_type: bh2
        lower_order_final: true
        use_dynamic_shifting: true
        shift: 3.0
    - name: DPMppSDEFlowScheduler
      label: DPM++ SDE Flow Scheduler
      description: DPM-Solver++ stochastic for flow-matching. Two evals per step with BrownianTree noise in logSNR space.
      base: src.scheduler.flow_sde.DPMppSDEFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        # eta: 0=ODE, 1=full SDE.  Flow models need lower eta (~0.25)
        # because noise/signal ratio is inherently high in the logSNR SDE.
        eta: 0.25
        s_noise: 1.0
    - name: DPMpp2MSDEFlowScheduler
      label: DPM++ 2M SDE Flow Scheduler
      description: DPM-Solver++(2M) SDE for flow-matching. Single eval with denoised history and BrownianTree noise.
      base: src.scheduler.flow_sde.DPMpp2MSDEFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        eta: 0.25
        s_noise: 1.0
    - name: DPMpp2MSDEHeunFlowScheduler
      label: DPM++ 2M SDE Heun Flow Scheduler
      description: DPM-Solver++(2M) SDE Heun variant for flow-matching. Uses Heun correction with BrownianTree noise.
      base: src.scheduler.flow_sde.DPMpp2MSDEHeunFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        eta: 0.25
        s_noise: 1.0
    - name: DPMpp3MSDEFlowScheduler
      label: DPM++ 3M SDE Flow Scheduler
      description: DPM-Solver++(3M) SDE for flow-matching. Single eval with 3rd-order correction and BrownianTree noise.
      base: src.scheduler.flow_sde.DPMpp3MSDEFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        eta: 0.15
        s_noise: 1.0
    - name: ExpHeun2X0SDEFlowScheduler
      label: Exp Heun 2 X0 SDE Flow Scheduler
      description: Stochastic exponential Heun 2nd-order in x0-prediction and logSNR time for flow-matching. Two evals per step with SDE noise.
      base: src.scheduler.flow_sde.ExpHeun2X0SDEFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        eta: 1.0
        s_noise: 1.0
    - name: ERSDEFlowScheduler
      label: ER-SDE Flow Scheduler
      description: Extended Reverse-Time SDE solver (VP ER-SDE-Solver-3) for flow-matching. Single eval with history-based corrections and noise injection.
      base: src.scheduler.flow_sde.ERSDEFlowScheduler
      config:
        num_train_timesteps: 1000
        shift: 3.0
        sigma_max: 1.0
        sigma_min: 0.002994011976047904
        s_noise: 1.0
        max_stage: 3
  - type: vae
    label: ZImage Turbo VAE
    base: auto
    config_path: totoku/apex-models/Z-Image/vae/config.json
    model_path:
    - path: totoku/apex-models/Z-Image/vae/vae-bf16.safetensors
      variant: default
      precision: bf16
      type: safetensors
  - type: text_encoder
    label: ZImage Text Encoder
    base: Qwen3ForCausalLM
    name: text_encoder
    config_path: totoku/apex-models/Z-Image/text_encoder/config.json
    model_path:
    - path: totoku/apex-models/Z-Image/text_encoder/text_encoder-bf16.safetensors
      variant: default
      precision: fp16
      type: safetensors
    - path: totoku/apex-models/Z-Image/text_encoder/text_encoder-fp8_e4m3fn.safetensors
      variant: FP8_E4M3FN
      precision: fp8_e4m3fn
      type: safetensors
    - path: totoku/apex-models/Z-Image/text_encoder/text_encoder-q8_0.gguf
      variant: GGUF_Q8_0
      precision: q8_0
      type: gguf
    tokenizer_class: Qwen2Tokenizer
    tokenizer_name: totoku/apex-models
    tokenizer_kwargs:
      subfolder: Z-Image/tokenizer
  - type: transformer
    label: ZImage Transformer
    base: zimage.base
    config_path: totoku/apex-models/Z-Image/transformer/config.json
    model_path:
    - path: totoku/apex-models/Z-Image/transformer/transformer-bf16.safetensors
      variant: default
      precision: bf16
      type: safetensors
    - path: totoku/apex-models/Z-Image/transformer/transformer-fp8_e4m3fn.safetensors
      variant: FP8_E4M3FN
      precision: fp8_e4m3fn
      type: safetensors
    - path: totoku/apex-models/Z-Image/transformer/transformer-q8_0.gguf
      variant: GGUF_Q8_0
      precision: q8_0
      type: gguf
    - path: totoku/apex-models/Z-Image/transformer/transformer-q6_k.gguf
      variant: GGUF_Q6_K
      precision: q6_k
      type: gguf
    - path: totoku/apex-models/Z-Image/transformer/transformer-q4_k_m.gguf
      variant: GGUF_Q4_K_M
      precision: q4_k_m
      type: gguf
  defaults:
    run:
      num_inference_steps: 50
      guidance_scale: 4.0
      return_latents: false
      attention_kwargs: {}
  ui:
    panels:
    - name: prompting
      label: Prompting
      collapsible: true
      default_open: true
      layout:
        flow: column
        rows:
        - - prompt
    - name: advanced_prompting
      label: Advanced Prompting
      collapsible: true
      default_open: false
      layout:
        flow: column
        rows:
        - - negative_prompt
    - name: size
      label: Size
      collapsible: true
      default_open: false
      layout:
        flow: column
        rows:
        - - resolution
        - - aspect_ratio
        - - height
          - width
    - name: sampling
      label: Sampling
      collapsible: true
      default_open: false
      layout:
        flow: column
        rows:
        - - seed
        - - num_inference_steps
        - - guidance_scale
    inputs:
    - id: prompt
      label: Prompt
      description: The prompt for text-to-image generation.
      placeholder: A serene lake surrounded by pine trees at sunrise, ultra realistic.
      type: text
      panel: prompting
      required: true
    - id: negative_prompt
      label: Negative Prompt
      description: The negative prompt for text-to-image generation.
      placeholder: blurry, low quality, distorted, artifacts
      type: text
      panel: prompting
      default: ' '
      required: false
    - id: resolution
      label: Resolution
      description: Select the resolution of the output image
      panel: size
      type: select
      default: 1024
      options:
      - name: 2K Ultra HD
        value: 2048
        height: 2048
      - name: Ultra HD
        value: 1024
      - name: HD
        value: 720
      - name: SD
        value: 480
      - name: Custom
        value: custom
    - id: aspect_ratio
      label: Aspect Ratio
      description: Select the aspect ratio of the output image
      panel: size
      type: select
      default: '1:1'
      options:
      - name: Wide
        value: '16:9'
        ratio_w: 16
        ratio_h: 9
      - name: Vertical
        value: '9:16'
        ratio_w: 9
        ratio_h: 16
      - name: Square
        value: '1:1'
        ratio_w: 1
        ratio_h: 1
      - name: Classic
        value: '4:3'
        ratio_w: 4
        ratio_h: 3
      - name: Custom
        value: custom
    - id: height
      label: Height
      description: Explicit height override
      type: number
      value_type: integer
      panel: size
      default: 2048
      min: 256
      max: 8192
      step: 32
    - id: width
      label: Width
      description: Explicit width override
      type: number
      value_type: integer
      panel: size
      default: 2048
      min: 256
      max: 8192
      step: 32
    - id: seed
      label: Seed
      description: Random seed for reproducibility
      type: random
      default: -1
      min: 0
      max: 4294967295
      value_type: integer
      panel: sampling
      required: false
    - id: num_inference_steps
      label: Number of Inference Steps
      description: The number of inference steps to use for the generation.
      type: number
      value_type: integer
      panel: sampling
      required: false
      default: 50
      min: 1
      max: 100
      step: 1
    - id: guidance_scale
      label: Guidance Scale
      description: The guidance scale for the generation.
      type: number
      value_type: float
      panel: sampling
      required: false
      default: 4.0
      min: 1.0
      max: 15.0
