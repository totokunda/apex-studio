api_version: apex/v1
kind: Model
metadata:
  id: wan-2-1-14b-multitalk
  model: wan
  name: Wan 2.1 14B MultiTalk
  version: 1.0.0
  description: Wan 2.1 14B MultiTalk is a 14B parameter model for multi talk generation.
  tags:
  - wan
  - multitalk
  - 14b
  - '2.1'
  author: Meigen AI
  license: Apache-2.0
  demo_path: models/multitalk.mp4
  categories:
  - audio-to-video
spec:
  engine: wan
  model_type: multitalk
  denoise_type: base
  engine_type: torch
  default_duration_secs: 5.0
  min_duration_secs: 1.0
  fps: 25
  audio_inputs_to_save:
  - person_1_audio
  - person_2_audio
  compute_requirements:
    min_cuda_compute_capability: 7.5
    supported_compute_types:
    - cuda
    - cpu
    - metal
  attention_types:
  - sdpa
  - flash
  - flash3
  - sage
  - efficient_dot_product_attention
  loras:
  - source: vrgamedevgirl84/Wan14BT2VFusioniX/FusionX_LoRa/Wan2.1_I2V_14B_FusionX_LoRA.safetensors
    scale: 1.0
    name: fusionx_lora
    label: FusionX LoRA
    component: transformer
    verified: true
  components:
  - type: scheduler
    label: Scheduler
    default: FlowMatchScheduler
    scheduler_options:
    - name: FlowMatchScheduler
      label: FlowMatch Scheduler
      description: The FlowMatch Scheduler is used for WAN 2.1 14B MultiTalk Text
        to Video.
      base: src.scheduler.FlowMatchScheduler
    config:
      shift: 7.0
      sigma_max: 1.0
      sigma_min: 0.001
      inverse_timesteps: false
      extra_one_step: false
      reverse_sigmas: false
  - type: vae
    name: wan/vae
    label: Wan VAE
    base: wan
    model_path:
    - path: Wan-AI/Wan2.2-I2V-A14B-Diffusers/vae
      variant: default
      precision: fp16
      type: safetensors
      file_size: 507592616
      resource_requirements:
        min_vram_gb: 8
        recommended_vram_gb: 12
    config_path: https://huggingface.co/Wan-AI/Wan2.1-I2V-14B-480P-Diffusers/resolve/main/vae/config.json
  - type: text_encoder
    label: WAN Text Encoder
    base: UMT5EncoderModel
    offloading_module: encoder
    model_path:
    - path: Wan-AI/Wan2.2-I2V-A14B-Diffusers/text_encoder
      variant: default
      precision: fp16
      type: safetensors
      file_size: 11361874539
      resource_requirements:
        min_vram_gb: 15
        recommended_vram_gb: 20
    - path: Kijai/WanVideo_comfy/umt5-xxl-enc-fp8_e4m3fn.safetensors
      variant: FP8
      precision: fp8
      type: safetensors
      file_size: 6731333792
      resource_requirements:
        min_vram_gb: 13
        recommended_vram_gb: 18
    config_path: Wan-AI/Wan2.1-I2V-14B-480P-Diffusers/text_encoder/config.json
  - type: transformer
    base: wan.multitalk
    model_path:
    - path: Wan-AI/Wan2.1-I2V-14B-480P-Diffusers/transformer
      variant: default
      precision: fp16
      type: safetensors
      file_size: 57154175562
      resource_requirements:
        min_vram_gb: 47
        recommended_vram_gb: 63
    - path: Kijai/WanVideo_comfy_fp8_scaled/I2V/Wan2_1-I2V-14B-480p_fp8_e4m3fn_scaled_KJ.safetensors
      variant: FP8
      precision: fp8
      type: safetensors
      file_size: 16643349018
      resource_requirements:
        min_vram_gb: 20
        recommended_vram_gb: 27
    - path: city96/Wan2.1-I2V-14B-480P-gguf/wan2.1-i2v-14b-480p-Q8_0.gguf
      variant: GGUF_Q8_0
      precision: q8_0
      type: gguf
      file_size: 18144640384
      resource_requirements:
        min_vram_gb: 19
        recommended_vram_gb: 26
    - path: city96/Wan2.1-I2V-14B-480P-gguf/wan2.1-i2v-14b-480p-Q6_K.gguf
      variant: GGUF_Q6_K
      precision: q6_k
      type: gguf
      file_size: 14233779584
      resource_requirements:
        min_vram_gb: 13
        recommended_vram_gb: 18
    - path: city96/Wan2.1-I2V-14B-480P-gguf/wan2.1-i2v-14b-480p-Q5_K_M.gguf
      variant: GGUF_Q5_K_M
      precision: q5_k_m
      type: gguf
      file_size: 12743654784
      resource_requirements:
        min_vram_gb: 11
        recommended_vram_gb: 15
    - path: city96/Wan2.1-I2V-14B-480P-gguf/wan2.1-i2v-14b-480p-Q5_K_S.gguf
      variant: GGUF_Q5_K_S
      precision: q5_k_s
      type: gguf
      file_size: 12089113984
      resource_requirements:
        min_vram_gb: 11
        recommended_vram_gb: 15
    - path: city96/Wan2.1-I2V-14B-480P-gguf/wan2.1-i2v-14b-480p-Q4_K_M.gguf
      variant: GGUF_Q4_K_M
      precision: q4_k_m
      type: gguf
      file_size: 11341184384
      resource_requirements:
        min_vram_gb: 9
        recommended_vram_gb: 13
    - path: city96/Wan2.1-I2V-14B-480P-gguf/wan2.1-i2v-14b-480p-Q4_K_S.gguf
      variant: GGUF_Q4_K_S
      precision: q4_k_s
      type: gguf
      file_size: 10437606784
      resource_requirements:
        min_vram_gb: 9
        recommended_vram_gb: 13
    - path: city96/Wan2.1-I2V-14B-480P-gguf/wan2.1-i2v-14b-480p-Q3_K_M.gguf
      variant: GGUF_Q3_K_M
      precision: q3_k_m
      type: gguf
      file_size: 8587033984
      resource_requirements:
        min_vram_gb: 9
        recommended_vram_gb: 13
    - path: city96/Wan2.1-I2V-14B-480P-gguf/wan2.1-i2v-14b-480p-Q3_K_S.gguf
      variant: GGUF_Q3_K_S
      precision: q3_k_s
      type: gguf
      file_size: 7925939584
      resource_requirements:
        min_vram_gb: 9
        recommended_vram_gb: 13
    config_path: Wan-AI/Wan2.1-I2V-14B-480P-Diffusers/transformer/config.json
  - type: extra_model_path
    label: Wan 2.1 14B MultiTalk Transformer
    name: multitalk_transformer
    component: transformer
    model_path:
    - path: MeiGen-AI/MeiGen-MultiTalk/multitalk.safetensors
      variant: default
      precision: fp16
      type: safetensors
      file_size: 9947889040
      resource_requirements:
        min_vram_gb: 12
        recommended_vram_gb: 16
  - type: helper
    base: wan.multitalk
    label: Chinese Wav2Vec2 Base
    extra_kwargs:
      ignore_model_load: true
    model_path:
    - path: TencentGameMate/chinese-wav2vec2-base
      file_size: 1520899445
      resource_requirements:
        min_vram_gb: 6
        recommended_vram_gb: 10
  - type: helper
    base: clip
    name: wan/clip
    label: Wan CLIP
    model_path:
    - path: Wan-AI/Wan2.1-I2V-14B-480P-Diffusers/image_encoder
      variant: default
      precision: fp16
      type: safetensors
      file_size: 1264218342
      resource_requirements:
        min_vram_gb: 5
        recommended_vram_gb: 9
    preprocessor_path: Wan-AI/Wan2.1-I2V-14B-480P-Diffusers/image_processor/preprocessor_config.json
    processor_class: CLIPImageProcessor
    model_class: CLIPVisionModel
  defaults:
    run:
      num_inference_steps: 30
      guidance_scale: 5.0
      boundary_ratio: 0.9
      return_latents: false
      text_encoder_kwargs: {}
      use_attention_mask: true
      attention_kwargs: {}
  ui:
    panels:
    - name: image_input
      label: Image Input
      collapsible: true
      default_open: true
      layout:
        flow: column
        rows:
        - - image
    - name: audio_input
      label: Audio
      collapsible: true
      default_open: true
      layout:
        flow: column
        rows:
        - - person_1_audio
        - - person_2_audio
    - name: prompting
      label: Prompting
      collapsible: true
      default_open: true
      layout:
        flow: column
        rows:
        - - prompt
    - name: advanced_prompting
      label: Advanced Prompting
      collapsible: true
      default_open: false
      layout:
        flow: column
        rows:
        - - negative_prompt
    - name: size
      label: Size
      collapsible: true
      default_open: false
      layout:
        flow: column
        rows:
        - - resolution
        - - aspect_ratio
        - - height
          - width
    - name: sampling
      label: Sampling
      collapsible: true
      default_open: false
      layout:
        flow: column
        rows:
        - - num_inference_steps
        - - guidance_scale
        - - audio_guidance_scale
        - - seed
        - - num_frames
        - - motion_frames
        - - chunking_profile  
    inputs:
    - id: image
      label: Image
      description: The image to use for the generation.
      type: image
      panel: image
      required: true
    - id: person_1_audio
      label: Audio
      description: The audio to use for the generation.
      type: audio
      panel: audio_input
      required: true
    - id: person_2_audio
      label: Audio
      description: The audio to use for the generation.
      type: audio
      panel: audio_input
      required: false
    - id: prompt
      label: Prompt
      description: Describe the video you want to generate.
      placeholder: A beautiful landscape at golden hour.
      type: text
      panel: prompting
      required: true
    - id: negative_prompt
      label: Negative Prompt
      description: Describe what to avoid in the generation.
      placeholder: blurry, low quality, distorted, artifacts
      type: text
      panel: advanced_prompting
      required: false
      default: lowres, text, error, cropped, worst quality, low quality, jpeg artifacts,
        ugly, duplicate, morbid, mutilated, out of frame, extra fingers, mutated hands,
        poorly drawn hands, poorly drawn face, mutation, deformed, blurry, dehydrated,
        bad anatomy, bad proportions, extra limbs, cloned face, disfigured, gross
        proportions, malformed limbs, missing arms, missing legs, extra arms, extra
        legs, fused fingers, too many fingers, long neck, username, watermark, signature
    - id: resolution
      label: Resolution
      description: Select the resolution of the output video
      panel: size
      type: select
      default: 480
      options:
      - name: HD
        value: 720
      - name: SD
        value: 480
      - name: Custom
        value: custom
    - id: aspect_ratio
      label: Aspect Ratio
      description: Select the aspect ratio of the output video
      panel: size
      type: select
      default: 969
      options:
      - name: Square
        value: 61
        ratio_w: 1
        ratio_h: 1
      - name: Wide
        value: 969
        ratio_w: 16
        ratio_h: 9
      - name: Vertical
        value: 556
        ratio_w: 9
        ratio_h: 16
      - name: Classic
        value: 243
        ratio_w: 4
        ratio_h: 3
      - name: Custom
        value: custom
    - id: num_inference_steps
      label: Inference Steps
      description: Number of denoising steps
      type: number+slider
      value_type: integer
      panel: sampling
      default: 8
      min: 1
      max: 100
      step: 1
    - id: height
      label: Height
      description: Explicit height override
      type: number
      value_type: integer
      panel: size
      default: 480
      min: 256
      max: 8192
      step: 16
    - id: width
      label: Width
      description: Explicit width override
      type: number
      value_type: integer
      panel: size
      default: 832
      min: 256
      max: 8192
      step: 16
    - id: seed
      label: Seed
      description: Random seed for reproducibility
      type: random
      default: -1
      min: 0
      max: 4294967295
      value_type: integer
      panel: sampling
      required: false
    - id: guidance_scale
      label: Guidance Scale
      type: number+slider
      value_type: float
      panel: sampling
      required: false
      default: 1.0
      min: 1.0
      max: 15.0
      step: 0.5
    - id: audio_guidance_scale
      label: Audio Guidance Scale
      type: number+slider
      value_type: float
      panel: sampling
      required: false
      default: 4.0
      min: 1.0
      max: 15.0
      step: 0.5
    - id: num_frames
      label: Number of Frames per Segment
      description: Number of frames to generate per segment
      type: number+slider
      value_type: integer
      panel: sampling
      default: 81
      min: 1
      max: 200
      step: 1
    - id: motion_frames
      label: Number of Motion Frames
      description: Number of motion frames to look back for the next input image
      type: number+slider
      value_type: integer
      panel: sampling
      default: 25
      min: 0
      max: 100
      step: 1
    - id: chunking_profile
      label: Chunking Profile
      description: Spliting tensors into smaller chunks to reduce memory usage.
      type: select
      panel: sampling
      default: light
      options:
      - name: None
        value: none
      - name: Light
        value: light
      - name: Balanced
        value: balanced
      - name: Aggressive
        value: aggressive